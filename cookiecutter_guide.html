

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to cookiecut Python package &mdash; scikit-package 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f539c95a"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to release Python package" href="release_guide.html" />
    <link rel="prev" title="Getting started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            scikit-package
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to cookiecut Python package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#warnings">WARNINGS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-commit-workflow">1. Pre-commit workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cookiecutter-main-workflow">1. Cookiecutter main workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-documentation-workflow">3. API documentation workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#final-sign-off">4. Final sign-off</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-1-codecov-token-setup-for-the-repository">Appendix 1. Codecov token setup for the repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-2-how-to-configure-pre-commit-ci-via-github-apps">Appendix 2. How to configure pre-commit CI via GitHub Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-3-how-to-test-your-package-locally">Appendix 3. How to test your package locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-4-how-to-build-documentation-locally">Appendix 4. How to build documentation locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-5-how-to-write-branch-name-rst-news-file">Appendix 5. How to write <code class="docutils literal notranslate"><span class="pre">&lt;branch-name&gt;.rst</span></code> news file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#motivation-and-audience">Motivation and audience</a></li>
<li class="toctree-l3"><a class="reference internal" href="#guidelines-for-writing-news-items">Guidelines for writing news items</a></li>
<li class="toctree-l3"><a class="reference internal" href="#where-to-place-the-news-item-in-branch-name-rst">Where to place the news item in <code class="docutils literal notranslate"><span class="pre">&lt;branch-name&gt;.rst</span></code>?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_guide.html">How to release Python package</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda_forge_guide.html">How to release conda-forge package</a></li>
<li class="toctree-l1"><a class="reference internal" href="frequently_asked_questions.html">Frequently asked questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">scikit-package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">How to cookiecut Python package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cookiecutter_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-cookiecut-python-package">
<span id="cookiecutter-title"></span><span id="index-0"></span><h1>How to cookiecut Python package<a class="headerlink" href="#how-to-cookiecut-python-package" title="Link to this heading"></a></h1>
<p id="cookiecutter-installation">The following creates and activates a new environment named <code class="docutils literal notranslate"><span class="pre">cookiecutter_env</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">cookiecutter_env</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.13</span>
</pre></div>
</div>
<p>Activate the environment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">cookiecutter_env</span>
</pre></div>
</div>
<p>Install packages</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cookiecutter</span> <span class="n">black</span> <span class="n">pre</span><span class="o">-</span><span class="n">commit</span>
</pre></div>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The cookiecutting is divided into four sections:</p>
<ol class="arabic simple">
<li><p>Pre-commit workflow: Use <code class="docutils literal notranslate"><span class="pre">black</span></code> and <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> to standardize line lengths and remove flake8 errors.</p></li>
<li><p>Cookiecutting workflow: Use the Cookiecutter project setup and move files from an older to a new structure with Pytest passing.</p></li>
<li><p>API documentation build workflow: Use a script to build and host API documentation.</p></li>
<li><p>Codecov token setup for the repository.</p></li>
</ol>
</section>
<section id="warnings">
<h2>WARNINGS<a class="headerlink" href="#warnings" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Do not delete/remove any files before confirming that it is absolutely not necessary. Create an issue or contact the maintainer for assistance.</p></li>
<li><p>When copying over documentation files, make sure you include any additional package-specific information that may be in those files.</p></li>
<li><p>For instance, there may be a more verbose description of what the package does, or tutorial/example/utility files.</p></li>
</ul>
</section>
<section id="pre-commit-workflow">
<h2>1. Pre-commit workflow<a class="headerlink" href="#pre-commit-workflow" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>In your <code class="docutils literal notranslate"><span class="pre">dev</span></code> folder, fork and clone the package.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span></code> into the top-level directory of that project.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span> <span class="pre">main</span></code> to sync with the main branch.</p></li>
<li><p>Double-check that no bug-fix etc. pull-requests are waiting to be merged. Check with Simon if not sure.</p></li>
<li><p>Create a new branch called <code class="docutils literal notranslate"><span class="pre">black</span></code>.</p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>. Copy and paste the <code class="docutils literal notranslate"><span class="pre">[tools.black]</span></code> and <code class="docutils literal notranslate"><span class="pre">[tool.codespell]</span></code> sections from <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> in the <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">cookiecutter.github_repo_name</span> <span class="pre">}}</span></code> folder path.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">black</span> <span class="pre">src</span></code> (note: some of the older packages do not have an <code class="docutils literal notranslate"><span class="pre">src</span></code> directory, so you may have to run black on a different directory).</p></li>
<li><p>Commit the automatic changes by <code class="docutils literal notranslate"><span class="pre">black</span></code>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">black</span> <span class="pre">.</span></code> and create a PR into <code class="docutils literal notranslate"><span class="pre">main</span></code>. Follow the group’s GitHub workflow tutorial on GitLab.</p></li>
<li><p>After the <code class="docutils literal notranslate"><span class="pre">black</span></code> branch has been merged, run pytest or unit tests to ensure all tests pass locally. If the code is failing, please consult with Simon before further proceeding.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">main</span> <span class="pre">&amp;&amp;</span> <span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span> <span class="pre">main</span></code> and create a new branch called <code class="docutils literal notranslate"><span class="pre">precommit</span></code>.</p></li>
<li><p>Copy and paste the <code class="docutils literal notranslate"><span class="pre">.flake8</span></code> and <code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code> files from <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">cookiecutter.github_repo_name</span> <span class="pre">}}</span></code> to the top directory level. Cross-check with <a class="reference external" href="https://github.com/diffpy/diffpy.utils">https://github.com/diffpy/diffpy.utils</a>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">pre-commit</span> <span class="pre">run</span> <span class="pre">--all-files</span></code>. Fix any spelling suggestions from Codespell. To ignore a specific word or line, add it under  <code class="docutils literal notranslate"><span class="pre">.codespell/ignore_words.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">.codespell/ignore_lines.txt</span></code>. To ignore specific file types, add the file extensions i.e. <code class="docutils literal notranslate"><span class="pre">*.gr</span></code> in <code class="docutils literal notranslate"><span class="pre">skip</span> <span class="pre">=</span> <span class="pre">line</span></code> under <code class="docutils literal notranslate"><span class="pre">[tool.codespell]</span></code> in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>. Include explanations for each addition.</p></li>
<li><p>Create a PR to <code class="docutils literal notranslate"><span class="pre">main</span></code>. Mention in the PR that you need to address flake8 errors.</p></li>
<li><p>After the <code class="docutils literal notranslate"><span class="pre">precommit</span></code> branch has been merged, sync with <code class="docutils literal notranslate"><span class="pre">main</span></code> in Step 11, create a new branch called <code class="docutils literal notranslate"><span class="pre">flake8</span></code>.</p></li>
<li><p>Fix flake8 errors manually:</p>
<ul class="simple">
<li><p>Tip 1: Start with easier error types to fix, such as line-lengths and “module imported not used”, etc.</p></li>
<li><p>Tip 2: Submit periodic commits within a single PR.</p></li>
<li><p>Tip 3: Create multiple PRs, each containing a specific theme (e.g., “Fix docstring line-length flake8 errors” using <code class="docutils literal notranslate"><span class="pre">flake8-length</span></code> branch, etc.) to reduce cognitive overload for the reviewer (Simon).</p></li>
<li><p>Tip 4: Don’t hesitate to reach out to group members who have contributed to this repository. They probably have seen those errors before!</p></li>
</ul>
</li>
<li><p>Only proceed to the next section after addressing all PRs relevant to the pre-commit workflow.</p></li>
</ol>
</section>
<section id="cookiecutter-main-workflow">
<span id="cookiecutter-workflow-main"></span><h2>1. Cookiecutter main workflow<a class="headerlink" href="#cookiecutter-main-workflow" title="Link to this heading"></a></h2>
<p>Please follow the instructions in the <a class="reference external" href="_cookiecutter-installation">installation</a> section.</p>
<ol class="arabic simple">
<li><p>Type <code class="docutils literal notranslate"><span class="pre">cookiecutter</span> <span class="pre">https://github.com/billingegroup/cookiecutter</span></code> inside the package directory.</p></li>
<li><p>Answer the questions as the following – note that (default) means to hit enter without modifying anything:</p>
<ol class="arabic simple">
<li><p>(May occur if it is not the first time you have installed) Is it okay to delete: (y)</p></li>
<li><p>github_org: diffpy (if diffpy project) or billingegroup</p></li>
<li><p>keywords: current keywords in the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> or <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> in comma-separated string format, e.g., <code class="docutils literal notranslate"><span class="pre">diffpy,</span> <span class="pre">pdf,</span> <span class="pre">something,</span> <span class="pre">something</span> <span class="pre">else</span></code> (no quotes around it)</p></li>
<li><p>project_name: &lt;name_of_project (e.g. <code class="docutils literal notranslate"><span class="pre">diffpy.pdfmorph</span></code>)&gt;</p></li>
<li><p>conda_pypi_package_dist_name: (default)</p></li>
<li><p>package_dir_name: (default)</p></li>
<li><p>github_repo_name: (default)</p></li>
<li><p>minimum_python_version: (default – this is 3.11)</p></li>
<li><p>maximum_python_version: (default – this is 3.13)</p></li>
<li><p>have_c_code: no (in general, but if there are C++ extensions, this will be yes)</p></li>
<li><p>Is a GUI application, run ‘HEADLESS’ tests (default: false): (default). If it is a GUI package, change this to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p>Enter value for workflow ‘VERSION’ (default: v0): (default). Version of the workflow to use.</p></li>
</ol>
</li>
</ol>
<p>If you are starting a new project, you can skip the following sections and proceed to the API documentation workflow below.</p>
<ol class="arabic simple" start="4">
<li><p>cd into the new <code class="docutils literal notranslate"><span class="pre">diffpy.&lt;package_name&gt;/</span></code> directory (e.g., in our example <code class="docutils literal notranslate"><span class="pre">pwd</span></code> would return <code class="docutils literal notranslate"><span class="pre">~/dev/diffpy.pdfmorph/diffpy.pdfmorph</span></code>) (we will refer to the nested directory as the “<strong>cookiecutter</strong>” directory and <code class="docutils literal notranslate"><span class="pre">~/dev/diffpy.pdfmorph/</span></code> as the “<strong>main</strong>” directory).</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-als</span></code> (if you have the alias, this is <code class="docutils literal notranslate"><span class="pre">ll</span></code>) compare the directory structures in this directory tree to that in the original repo to see what is different (ignore files at this point). Nothing to do here, just get familiar with the differences.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">mv</span> <span class="pre">../.git</span> <span class="pre">.</span></code> to move the <code class="docutils literal notranslate"><span class="pre">.git</span></code> directory from the main repo to the cookiecutter repo.</p></li>
<li><p>Create a new branch for all the changes, e.g., <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">cookierelease</span></code>.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-n</span> <span class="pre">-r</span> <span class="pre">../src</span> <span class="pre">.</span></code> to copy the source code from the main to the cookiecutter repo, without overwriting existing files in the destination. If there is no src directory, it will be something like <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-n</span> <span class="pre">-r</span> <span class="pre">../diffpy</span> <span class="pre">./src</span></code>.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> to see a list of files that have been (1) untracked, (2) deleted, (3) modified. Untracked files are in the cookiecutter but not in the original repo, deleted files are in the original but haven’t been moved over, and modified files are in both but have been changed.</p></li>
<li><p>Let’s now copy over any documentation, similar to what we did with the src files. We want to copy over everything in the <code class="docutils literal notranslate"><span class="pre">doc/&lt;path&gt;/source</span></code> file from the old repo to the <code class="docutils literal notranslate"><span class="pre">doc/source</span></code> file in the new repo.</p>
<ol class="arabic simple">
<li><p>If you see this extra <code class="docutils literal notranslate"><span class="pre">manual</span></code> directory, run <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-n</span> <span class="pre">-r</span> <span class="pre">../doc/manual/source/*</span> <span class="pre">./doc/source</span></code>.</p></li>
<li><p>If files are moved to a different path, open the project in PyCharm and do a global search (ctrl + shift + f) for <code class="docutils literal notranslate"><span class="pre">../</span></code> or <code class="docutils literal notranslate"><span class="pre">..</span></code> and modify all relative path instances.</p></li>
</ol>
</li>
<li><p>Now we will work on correcting all the things that are wrong.</p>
<ol class="arabic simple">
<li><p>Add and commit each of the (1) untracked files to the git repo. These files are in the cookiecutter repo but not in the main repo, so can simply be “git added”. Do it one (or a few) at a time to make it easier to rewind by having multiple commits.</p></li>
<li><p>Make a PR of your <code class="docutils literal notranslate"><span class="pre">cookierelease</span></code> branch by pushing your fork and opening a PR.</p></li>
<li><p>Files showing as (2) “deleted” upon git status are in the main repo but not in the cookiecutter repo. We took care of most of these by moving over the src tree, but let’s do the rest now. Go down the list and for &lt;filename&gt; in the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> “delete” files type <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-n</span> <span class="pre">../&lt;filepath&gt;/&lt;filename&gt;</span> <span class="pre">./&lt;target_filepath&gt;</span></code>. Do not move files that we do not want. If you are unsure, feel free to confirm with Simon.</p></li>
<li><p>Files that have been (3) modified exist in both places and need to be merged <strong>manually</strong>. Do these one at a time. First open the file in PyCharm, then select <code class="docutils literal notranslate"><span class="pre">Git|current</span> <span class="pre">file|show</span> <span class="pre">diff</span></code> and the differences will show up. Select anything you want to inherit from the file in the main repo. For example, you want to copy useful information such as LICENSE and README files from the main repo to the cookiecutter repo.</p></li>
<li><p>Any files that we moved over from the old place, but put into a new location in the new repo, we need to delete them from git. For example, files that were in <code class="docutils literal notranslate"><span class="pre">doc/manual/source/</span></code> in the old repo but are not <code class="docutils literal notranslate"><span class="pre">doc/source</span></code> we correct by typing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">doc/manual/source</span></code>.</p></li>
</ol>
</li>
<li><p>Run pytest <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pytest</span></code> to make sure everything is working. There should be no errors if all tests passed previously when you were working on pre-commit. You may encounter deprecation warnings. There might be several possibilities:</p>
<ol class="arabic simple">
<li><p>If you see numpy deprecation warnings, we won’t clean up these deprecations now. Pin numpy to 1.x for now to get tests to pass. Do code fixes separate from cookiecuttering. Remember to add it to Github issue.</p></li>
<li><p>Most <code class="docutils literal notranslate"><span class="pre">pkg_resources</span></code> deprecation warnings will be fixed by cookiecutter, but if you are in a diffpy package using unittests and see this warning you can fix them by replacing <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">pkg_resources</span> <span class="pre">import</span> <span class="pre">resource_filename</span></code> with <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">importlib</span> <span class="pre">import</span> <span class="pre">resources</span></code> and change <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">=</span> <span class="pre">resource_filename(__name__,</span> <span class="pre">p)</span></code> to <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">=</span> <span class="pre">str(resources.files(__name__).joinpath(p))</span></code>. If you see <code class="docutils literal notranslate"><span class="pre">collected</span> <span class="pre">0</span> <span class="pre">items</span> <span class="pre">no</span> <span class="pre">tests</span> <span class="pre">ran</span></code> you might want to rename testing files as <code class="docutils literal notranslate"><span class="pre">test_*.py</span></code>. Refer to the [migration guide](<a class="reference external" href="https://importlib-resources.readthedocs.io/en/latest/migration.html">https://importlib-resources.readthedocs.io/en/latest/migration.html</a>).</p></li>
</ol>
</li>
</ol>
</section>
<section id="api-documentation-workflow">
<span id="cookiecutter-workflow-api"></span><h2>3. API documentation workflow<a class="headerlink" href="#api-documentation-workflow" title="Link to this heading"></a></h2>
<p>This should be done only when the above steps are finished.</p>
<p>When you see files with <code class="docutils literal notranslate"><span class="pre">..automodule::</span></code> within them, these are API documentation. However, these are not populated. We will populate them using our release scripts.</p>
<ol class="arabic simple">
<li><p>Make sure you have our release scripts repository. Go to <code class="docutils literal notranslate"><span class="pre">dev</span></code> and run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/Billingegroup/release-scripts.git</span></code>.</p></li>
<li><p>Enter your cookiecutter package directory. For example, I would run <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">./diffpy.pdfmorph/diffpy.pdfmorph</span></code>.</p></li>
<li><p>Build the package using <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">build</span></code>. You may have to install <code class="docutils literal notranslate"><span class="pre">python-build</span></code> first.</p></li>
<li><p>Get the path of the package directory proper. In the case of <code class="docutils literal notranslate"><span class="pre">diffpy.pdfmorph</span></code>, this is <code class="docutils literal notranslate"><span class="pre">./src/diffpy/pdfmorph</span></code>. In general, for <code class="docutils literal notranslate"><span class="pre">a.b.c</span></code>, this is <code class="docutils literal notranslate"><span class="pre">./src/a/b/c</span></code>.</p></li>
<li><p>Run the API script. This is done by running <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">&lt;path_to_auto_api&gt;</span> <span class="pre">&lt;package_name&gt;</span> <span class="pre">&lt;path_to_package_proper&gt;</span> <span class="pre">&lt;path_to_api_directory&gt;</span></code>.</p>
<ol class="arabic simple">
<li><p>If you have followed the steps above, the command is <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">../../release-scripts/auto_api.py</span> <span class="pre">&lt;package_name&gt;</span> <span class="pre">&lt;path_to_package_proper&gt;</span> <span class="pre">./doc/source/api</span></code>.</p></li>
</ol>
</li>
</ol>
<p>Make sure you build the documentation by going to <code class="docutils literal notranslate"><span class="pre">/doc</span></code> and running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>.
The error “No module named” (<code class="docutils literal notranslate"><span class="pre">e.g.</span> <span class="pre">WARNING:</span> <span class="pre">autodoc:</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">import</span> <span class="pre">module</span> <span class="pre">'tools'</span> <span class="pre">from</span> <span class="pre">module</span> <span class="pre">'diffpy.pdfmorph';</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">exception</span> <span class="pre">was</span> <span class="pre">raised:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'diffpy.utils'</span></code>) can be resolved by adding <code class="docutils literal notranslate"><span class="pre">autodoc_mock_imports</span> <span class="pre">=</span> <span class="pre">[&lt;pkg&gt;]</span></code> to your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> right under imports. This file is located in <code class="docutils literal notranslate"><span class="pre">/doc/source/conf.py</span></code>.
In the case of <code class="docutils literal notranslate"><span class="pre">PDFmorph</span></code>, this was done by adding <code class="docutils literal notranslate"><span class="pre">autodoc_mock_imports</span> <span class="pre">=</span> <span class="pre">[&quot;diffpy.utils&quot;,]</span></code>.</p>
<p>Congratulations! You may now commit the changes made by <code class="docutils literal notranslate"><span class="pre">auto_api.py</span></code> (and yourself) and push this commit to the cloud!
Make a PR! It will be merged, trust!</p>
</section>
<section id="final-sign-off">
<h2>4. Final sign-off<a class="headerlink" href="#final-sign-off" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>For the <code class="docutils literal notranslate"><span class="pre">cookierelease</span></code> activity make a <code class="docutils literal notranslate"><span class="pre">&lt;branchname&gt;.rst</span></code> file by copying <code class="docutils literal notranslate"><span class="pre">TEMPLATE.rst</span></code> in the news folder and under “fixed” put <code class="docutils literal notranslate"><span class="pre">Repo</span> <span class="pre">structure</span> <span class="pre">modified</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">diffpy</span> <span class="pre">standard</span></code></p></li>
<li><p>If a new Python version has been added under “added” add <cite>Python 3.xx, 3,xx support</cite>. If a previous version has been removed, under “fixed”, add a new item <cite>Python 3.xx, 3.xx, support</cite>.</p></li>
<li><p>Check the <cite>README</cite> and make sure that all parts have been filled in and all links resolve correctly.</p></li>
<li><p>Run through the documentation online and do the same, fix any last typos and make all the links work. To do this the documentation must have been correctly built on a merge to main and enabled on the github.io website. Instructions are [here](<a class="reference external" href="https://gitlab.thebillingegroup.com/resources/group-wiki/-/wikis/Maintaining-and-Deploying-Documentation">https://gitlab.thebillingegroup.com/resources/group-wiki/-/wikis/Maintaining-and-Deploying-Documentation</a>).</p></li>
<li><p>When you are are happy to sign off on the release send a Slack message to Simon saying something like “<cite>OK to release diffpy.&lt;package-name&gt;</cite>”</p></li>
<li><p>Make sure that the codecov secret is set in the GH actions repository secrets.</p></li>
</ol>
</section>
<section id="appendix-1-codecov-token-setup-for-the-repository">
<h2>Appendix 1. Codecov token setup for the repository<a class="headerlink" href="#appendix-1-codecov-token-setup-for-the-repository" title="Link to this heading"></a></h2>
<p>For each PR, we use <code class="docutils literal notranslate"><span class="pre">Codecov</span></code> to report the test coverage percentage change as shown below.</p>
<img alt="codecov-in-pr-comment" src="_images/codecov-pr.png" />
<p>To do so, the repository owner (Prof. Billinge) needs to provide a <code class="docutils literal notranslate"><span class="pre">CODECOV_TOKEN</span></code> at the repository level. This token is used to authenticate the GitHub CI with Codecov. Please follow the step-by-step guide below.</p>
<ol class="arabic simple">
<li><p>Visit <a class="reference external" href="https://app.codecov.io/">https://app.codecov.io/</a></p></li>
<li><p>Connect your repository or organization with Codecov by clicking <code class="docutils literal notranslate"><span class="pre">Configure</span> <span class="pre">Codecov's</span> <span class="pre">GitHub</span> <span class="pre">app</span></code>, shown below:</p></li>
</ol>
<img alt="codecov-configure-github-project-button" src="_images/codecov-configure.png" />
<ol class="arabic simple" start="3">
<li><p>Scroll down, find your repository of interest, and click <code class="docutils literal notranslate"><span class="pre">Configure</span></code>, shown below:</p></li>
</ol>
<img alt="codecov-list-github-projects" src="_images/codecov-projects.png" />
<ol class="arabic simple" start="4">
<li><p>Scroll down again, copy <code class="docutils literal notranslate"><span class="pre">CODECOV_TOKEN</span></code>, shown below:</p></li>
</ol>
<img alt="codecov-list-github-projects" src="_images/codecov-token.png" />
<ol class="arabic simple" start="5">
<li><p>In your GitHub repository, go to <code class="docutils literal notranslate"><span class="pre">Settings</span></code>, then click <code class="docutils literal notranslate"><span class="pre">Actions</span></code> under the <code class="docutils literal notranslate"><span class="pre">Secrets</span> <span class="pre">and</span> <span class="pre">Variables</span></code> tab.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">repository</span> <span class="pre">secret</span></code>.</p></li>
<li><p>Paste the token value and name it as <code class="docutils literal notranslate"><span class="pre">CODECOV_TOKEN</span></code> secret as shown below:</p></li>
</ol>
<img alt="codecov-list-github-projects" src="_images/codecov-github.png" />
<ol class="arabic simple" start="8">
<li><p>Done. The Codecov token is now set up for the repository. A comment will be generated on each PR with the Codecov status automatically.</p></li>
</ol>
</section>
<section id="appendix-2-how-to-configure-pre-commit-ci-via-github-apps">
<h2>Appendix 2. How to configure pre-commit CI via GitHub Apps<a class="headerlink" href="#appendix-2-how-to-configure-pre-commit-ci-via-github-apps" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Pre-commit</span> <span class="pre">CI</span></code> is available as a GitHub app that executes pre-commit hooks in each pull request, as shown in the image below. While it is recommended to run <code class="docutils literal notranslate"><span class="pre">precommit</span> <span class="pre">run</span> <span class="pre">--all-files</span></code> locally before making a PR, this GitHub app will automatically attempt to lint code and format docstrings according to the hooks provided in <code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code>. If all passes, it will give you a green checkmark as shown below.</p>
<img alt="pre-commit-PR-automatic-check" src="_images/precommit-PR.png" />
<p>To configure <code class="docutils literal notranslate"><span class="pre">pre-commit</span> <span class="pre">CI</span></code>, follow the simple steps below:</p>
<ol class="arabic simple">
<li><p>Visit <a class="reference external" href="https://github.com/apps/pre-commit-ci">https://github.com/apps/pre-commit-ci</a> and click “Configure”.</p></li>
<li><p>Select the repository(s).</p></li>
<li><p>Done!</p></li>
</ol>
</section>
<section id="appendix-3-how-to-test-your-package-locally">
<h2>Appendix 3. How to test your package locally<a class="headerlink" href="#appendix-3-how-to-test-your-package-locally" title="Link to this heading"></a></h2>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">diffpy.utils</span></code> package as an example. In the package directory, follow these instructions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new environment, specify the Python version and install packages</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>diffpy_utils_env<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.13<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--file<span class="w"> </span>requirements/test.txt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--file<span class="w"> </span>requirements/conda.txt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--file<span class="w"> </span>requirements/build.txt

<span class="c1"># Activate the environment</span>
conda<span class="w"> </span>activate<span class="w"> </span>diffpy_utils_env

<span class="c1"># Install your package locally</span>
<span class="c1"># `--no-deps` to NOT install packages again from `requirements.pip.txt`</span>
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="w"> </span>--no-deps

<span class="c1"># Run pytest locally</span>
pytest

<span class="c1"># ... run example tutorials</span>
</pre></div>
</div>
</section>
<section id="appendix-4-how-to-build-documentation-locally">
<h2>Appendix 4. How to build documentation locally<a class="headerlink" href="#appendix-4-how-to-build-documentation-locally" title="Link to this heading"></a></h2>
<p>Follow these steps sequentially:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>doc
make<span class="w"> </span>html
open<span class="w"> </span>build/html/index.html
</pre></div>
</div>
<p>To run as a single command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>doc<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>html<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>open<span class="w"> </span>build/html/index.html<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..
</pre></div>
</div>
<p>Alternatively, you may render the Sphinx documentation by installing the <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=swyddfa.esbonio">Esbonio</a> extension in VS Code. This will allow you to see the changes in real-time and increase productivity.</p>
</section>
<section id="appendix-5-how-to-write-branch-name-rst-news-file">
<h2>Appendix 5. How to write <code class="docutils literal notranslate"><span class="pre">&lt;branch-name&gt;.rst</span></code> news file<a class="headerlink" href="#appendix-5-how-to-write-branch-name-rst-news-file" title="Link to this heading"></a></h2>
<p>We require that each PR includes a news item of <code class="docutils literal notranslate"><span class="pre">&lt;branch-name&gt;.rst</span></code> file under the <code class="docutils literal notranslate"><span class="pre">news</span></code> directory.</p>
<section id="motivation-and-audience">
<h3>Motivation and audience<a class="headerlink" href="#motivation-and-audience" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">.rst</span></code> files under the <code class="docutils literal notranslate"><span class="pre">news</span></code> directory are used to compile and update the <code class="docutils literal notranslate"><span class="pre">CHANGELOG.rst</span></code> file during releases. Hence, these news items are of interest to both developers and technical users looking for specific keywords.</p>
</section>
<section id="guidelines-for-writing-news-items">
<h3>Guidelines for writing news items<a class="headerlink" href="#guidelines-for-writing-news-items" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Do not remove <code class="docutils literal notranslate"><span class="pre">news/TEMPLATE.rst</span></code>. Make a copy called <code class="docutils literal notranslate"><span class="pre">&lt;branch-name&gt;.rst</span></code>.</p></li>
<li><p>Do not modify other section headers in the rst file. Replace <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">&lt;news</span> <span class="pre">item&gt;</span></code> only. See example news files in <a class="reference external" href="https://github.com/bobleesj/diffpy.utils/blob/ba4b985df971440325442a50ac6de63eaad05fa5/news/no-empty-object.rst">Example 1</a> and <a class="reference external" href="https://github.com/bobleesj/diffpy.utils/blob/f79e88eadfcd7b58e84c6caa591a960d79689ba9/news/prettier-pre-commit.rst">Example 2</a>.</p></li>
<li><p>Begin with “No news”, “no news”, or “no news added” for trivial changes with the following format:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>**Added:**

* No news: &lt;brief reason&gt;
</pre></div>
</div>
</section>
<section id="where-to-place-the-news-item-in-branch-name-rst">
<h3>Where to place the news item in <code class="docutils literal notranslate"><span class="pre">&lt;branch-name&gt;.rst</span></code>?<a class="headerlink" href="#where-to-place-the-news-item-in-branch-name-rst" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">**Added:**</span></code> includes features or functionality of interest to users and developers, such as support for a new Python version or the addition of a useful feature.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Changed:**</span></code> includes modifications that affect end-users or developers, such as API changes or dependencies replaced.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Fixed:**</span></code> includes bug fixes or refactoring.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Deprecated:**</span></code> includes methods, classes, or workflows that are no longer supported in the future release.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Removed:**</span></code> includes the opposite of the “Added” section, referring to features or functionality that have been removed.</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="release_guide.html" class="btn btn-neutral float-right" title="How to release Python package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, The Trustees of Columbia University in the City of New York.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>